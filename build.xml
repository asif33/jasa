<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="compile" name="JASA">
   <property file="build.ant.properties"/>

   <property name="build.compiler" value="modern"/>
   <property name="sourceDir" value="src"/>
   <property name="outputDir" value="classes"/>
   <property name="projectName" value="JASA"/>
   <property name="packages" value="uk.ac.liv.auction,uk.ac.liv.auction.core,uk.ac.liv.auction.agent,uk.ac.liv.auction.agent.jade,uk.ac.liv.auction.stats,uk.ac.liv.auction.electricity,uk.ac.liv.auction.zi,uk.ac.liv.ai.learning,uk.ac.liv.util,uk.ac.liv.util.io,uk.ac.liv.auction.ui,uk.ac.liv.prng"/>
   <property name="docDir" value="doc"/>
   <property name="javaLibPath" value="./lib"/>
   <property name="jsciPath" value="${javaLibPath}/JSci/classes/core.jar:${javaLibPath}/JSci/classes/xtra.jar:${javaLibPath}/JSci/sci.jar:${javaLibPath}/JSci/JSciBeans.jar"/>
   <property name="ecjLoc" value="${javaLibPath}/ecj"/>
   <property name="rngpackLoc" value="${javaLibPath}/rngpack/rngpack.jar"/>
   <property name="junitLoc" value="${javaLibPath}/junit/junit.jar"/>
   <property name="log4jLoc" value="${javaLibPath}/log4j.jar"/>
   <property name="jadePath" value="${javaLibPath}/jade/lib/jade.jar:${javaLibPath}/jade/lib/jadeTools.jar:${javaLibPath}/jade/lib/iiop.jar:${javaLibPath}/jade/lib/Base64.jar"/>

   <path id="project.classpath">
     <pathelement path="${jsciPath}"/>
     <pathelement location="${ecjLoc}"/>
     <pathelement location="${junitLoc}"/>
     <pathelement location="${rngpackLoc}"/>
     <pathelement location="${log4jLoc}"/>     
     <pathelement path="${jadePath}"/> 
     <pathelement location="./classes"/>
     <pathelement path="${java.class.path}"/>
   </path>

   <target name="cleanOutput">
      <delete dir="${outputDir}"/>
   </target>

   <target depends="cleanOutput" name="prepareOutput">
      <mkdir dir="${outputDir}"/>
   </target>

   <target name="cleanDoc">
      <delete dir="${docDir}"/>
   </target>

   <target depends="cleanDoc" name="prepareDoc">
      <mkdir dir="${docDir}"/>
   </target>

   <target depends="prepareOutput" name="compile">
      <javac debug="on" deprecation="on" destdir="${outputDir}" source="1.4" srcdir="${sourceDir}">
        <classpath refid="project.classpath"/>
     </javac>
   </target>

   <target depends="compile,prepareDoc" name="doc">
     <javadoc author="true" destdir="${docDir}" packagenames="${packages}" source="1.4" sourcepath="${sourceDir}" windowtitle="${projectName}">
        <classpath refid="project.classpath"/>
     </javadoc>
   </target>

   <target depends="compile" name="jar">
   	<jar basedir="${outputDir}" jarfile="jasa.jar"/>
   </target>

   <target depends="jar,doc" name="tar">
   	<tar compression="gzip" tarfile="jasa.tar.gz">
		<tarfileset dir="." includes="jasa.jar,build.xml,readme.html,LICENSE.TXT,changelog*,doc/**,src/**/*.java,examples/*.params" prefix="jasa">
                  <exclude name="src/uk/ac/liv/ec/**"/>
                  <exclude name="src/uk/ac/liv/auction/ec/**"/>
				  <exclude name="src/uk/ac/liv/auction/heuristic/**/"/>
		 </tarfileset>
	</tar>
    </target>

    <target name="anoncvspass">
	    <cvspass cvsroot=":pserver:anonymous@cvs.sourceforge.net:/cvsroot/jasa" password=""/>
	</target>

   <target depends="anoncvspass" name="cvsupdate">
	   <cvs command="update" compression="3" cvsRoot=":pserver:anonymous@cvs.sourceforge.net:/cvsroot/jasa" cvsRsh="rsh"/>
    </target>

   <target depends="compile" name="test">
	   <java classname="test.uk.ac.liv.auction.AllTests" fork="true">
        	<classpath refid="project.classpath"/>
		<jvmarg value="-ea"/>
	   </java>
    </target>

    <target name="libtar">
    	<tar basedir="." compression="gzip" includes="lib/**" tarfile="lib.tar.gz"/>
    </target>


</project>
